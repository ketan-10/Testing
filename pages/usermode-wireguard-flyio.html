<html
  class="h-screen antialiased [font-feature-settings:'ss01'] __variable_dcab32 __variable_5d855b __variable_b4db0f __variable_669e4a __variable_cf3400 # bg-bg-200 scroll-smooth"
  lang="en"
  data-theme="claude"
  data-build-id="b9c2b5d82a"
  data-env=""
  data-mode="dark"
  style=""
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
    />

    <meta name="theme-color" content="hsl(60,2.7%,14.5%)" />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="from-bg-200 to-bg-100 text-text-100 font-styrene min-h-screen bg-gradient-to-b bg-fixed tracking-tight"
    style="pointer-events: auto"
  >
    <div
      role="region"
      aria-label="Notifications (F8)"
      tabindex="-1"
      style="pointer-events: none"
    >
      <ol
        tabindex="-1"
        class="fixed right-0 top-0 z-toast flex flex-col gap-4 p-4"
      ></ol>
    </div>
    <div class="flex min-h-screen w-full">
      <nav
        class="z-sidebar h-screen max-md:pointer-events-none max-md:fixed"
        data-testid="menu-sidebar"
        style="width: 4.5rem"
      ></nav>
      <div class="min-h-full w-full min-w-0 flex-1">
        <div class="flex h-screen w-full flex-col overflow-hidden">
          <div
            class="sticky top-0 z-10 -mb-6 flex h-14 items-center gap-3 pl-11 pr-2 md:pt-1 md:pb-0.5 md:pl-6"
          >
            <div
              class="from-bg-200 via-bg-200 to-bg-200/0 pointer-events-none absolute inset-0 -bottom-5 z-[-1] bg-gradient-to-b via-50% blur"
            ></div>
            <div
              class="flex min-w-0 flex-1 shrink flex-col md:flex-row md:items-center 2xl:justify-center"
            >
              <div class="flex min-w-0 items-center max-md:text-sm">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  fill="currentColor"
                  viewBox="0 0 256 256"
                  class="text-text-300 mr-1 shrink-0 translate-y-px"
                >
                  <path
                    d="M232.07,186.76a80,80,0,0,0-62.5-114.17A80,80,0,1,0,23.93,138.76l-7.27,24.71a16,16,0,0,0,19.87,19.87l24.71-7.27a80.39,80.39,0,0,0,25.18,7.35,80,80,0,0,0,108.34,40.65l24.71,7.27a16,16,0,0,0,19.87-19.86ZM62,159.5a8.28,8.28,0,0,0-2.26.32L32,168l8.17-27.76a8,8,0,0,0-.63-6,64,64,0,1,1,26.26,26.26A8,8,0,0,0,62,159.5Zm153.79,28.73L224,216l-27.76-8.17a8,8,0,0,0-6,.63,64.05,64.05,0,0,1-85.87-24.88A79.93,79.93,0,0,0,174.7,89.71a64,64,0,0,1,41.75,92.48A8,8,0,0,0,215.82,188.23Z"
                  ></path>
                </svg>
                <div class="font-tiempos truncate font-normal tracking-tight">
                  Technical Breakdown of Fly.io's Userspace SSH Solution
                </div>
              </div>
            </div>
            <div class="right-3 flex gap-2 md:absolute">
              <div
                class="bg-bg-300 text-text-300 rounded-full px-3 py-1.5 text-sm"
              >
                Shared by ketan
              </div>
            </div>
          </div>
          <div
            class="relative flex w-full flex-1 overflow-x-hidden overflow-y-scroll pt-6 md:pr-8"
            id="__FPSC_ID_1_1736707105937"
            style=""
          >
            <div
              class="relative mx-auto flex h-full w-full max-w-3xl flex-1 flex-col md:px-2"
            >
              <div
                class="flex-1 flex flex-col gap-3 px-4 max-w-3xl mx-auto w-full"
              >
                <div
                  class="border-0.5 border-border-400 text-text-400 flex items-center gap-2 rounded-xl px-3 py-2"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    fill="currentColor"
                    viewBox="0 0 256 256"
                    class="shrink-0"
                  >
                    <path
                      d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm16-40a8,8,0,0,1-8,8,16,16,0,0,1-16-16V128a8,8,0,0,1,0-16,16,16,0,0,1,16,16v40A8,8,0,0,1,144,176ZM112,84a12,12,0,1,1,12,12A12,12,0,0,1,112,84Z"
                    ></path>
                  </svg>
                  <p class="text-xs leading-snug">
                    Shared snapshot may contain attachments and data not
                    displayed here which may have altered Claude's responses.
                  </p>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            can you explain me this in bref techincally
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              I'll break down the key technical aspects of this
                              article:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Core Problem</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Fly.io needed to provide SSH access to their
                                customers' containerized applications running in
                                Firecracker micro-VMs
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Traditional SSH server setup wasn't ideal for
                                their container-based architecture
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong
                                  >Solution Part 1 - 6PN and Hallpass</strong
                                >:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>6PN</strong>: A private IPv6 network
                                system where:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Each app instance gets a unique IPv6 prefix
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Uses eBPF for routing packets through their
                                    WireGuard mesh
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Can be connected to external networks via
                                    WireGuard
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                <strong>Hallpass</strong>: A minimal SSH server
                                written in Go that:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Runs on all instances
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Uses SSH client certificates for
                                    authentication
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Validates certificates through their private
                                    DNS system
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="3"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong
                                  >Solution Part 2 - User-Mode WireGuard</strong
                                >:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Implemented a way to use WireGuard without
                                requiring system-level installation
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Key components:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Uses
                                    <code
                                      class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                      >wireguard-go</code
                                    >
                                    for userland WireGuard protocol handling
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Incorporates gVisor's TCP/IP stack
                                    implementation for user-mode networking
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Enables full TCP/IP networking without
                                    kernel privileges
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    Integrates with Go's standard networking
                                    library
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="4"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Technical Implementation</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Creates a synthetic TUN device using gVisor
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Implements user-mode TCP/IP stack
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Allows standard Go networking code to work over
                                this virtual network
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Slower than kernel TCP/IP but sufficient for
                                administrative tasks
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="5"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>End Result</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Users can SSH into their applications using a
                                simple command:
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >flyctl ssh shell</code
                                >
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                No need to install WireGuard system-wide
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Works with their private DNS system
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Can be extended to other services like
                                PostgreSQL access
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              The solution is particularly innovative because it
                              implements networking functionality that typically
                              requires kernel-level access entirely in
                              userspace, making it more portable and easier to
                              deploy.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <ol
                            class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                          >
                            <li class="whitespace-normal break-words">
                              <strong
                                >Solution Part 2 - User-Mode WireGuard</strong
                              >:
                            </li>
                            <li class="whitespace-normal break-words">
                              Implemented a way to use WireGuard without
                              requiring system-level installation
                            </li>
                            <li class="whitespace-normal break-words">
                              Key components:
                              <ul
                                class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              >
                                <li class="whitespace-normal break-words">
                                  Uses
                                  <code
                                    class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                    >wireguard-go</code
                                  >
                                  for userland WireGuard protocol handling
                                </li>
                                <li class="whitespace-normal break-words">
                                  Incorporates gVisor's TCP/IP stack
                                  implementation for user-mode networking
                                </li>
                                <li class="whitespace-normal break-words">
                                  Enables full TCP/IP networking without kernel
                                  privileges
                                </li>
                                <li class="whitespace-normal break-words">
                                  Integrates with Go's standard networking
                                  library
                                </li>
                              </ul>
                            </li>
                          </ol>
                          <p class="whitespace-pre-wrap break-words">
                            Let's talk about this. why creating user mode
                            wireguard need to create whole TCP/IP stack in
                            user-mode?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me explain why a user-mode TCP/IP stack is
                              necessary for user-mode WireGuard:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>WireGuard Protocol Flow</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                WireGuard operates at Layer 3 (Network Layer) of
                                the OSI model
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                It encapsulates IP packets inside encrypted UDP
                                datagrams
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                When receiving data, WireGuard decrypts and
                                outputs raw IP packets
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>The Core Problem</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                When WireGuard runs in kernel mode, it can
                                inject these decrypted IP packets directly into
                                the kernel's TCP/IP stack
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                But in user mode, WireGuard can only output raw
                                IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Your operating system doesn't provide a way to
                                handle raw IP packets in user space and convert
                                them into normal TCP connections
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="3"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Why TCP/IP Stack is Needed</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Let's say you want to make an SSH connection
                                over WireGuard:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Your SSH client wants to create a normal TCP
                                    connection
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    But WireGuard in user mode is giving you raw
                                    IP packets
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Something needs to:
                                    <ol
                                      class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                                      depth="2"
                                    >
                                      <li
                                        class="whitespace-normal break-words"
                                        index="0"
                                      >
                                        Convert TCP connection requests into IP
                                        packets for WireGuard
                                      </li>
                                      <li
                                        class="whitespace-normal break-words"
                                        index="1"
                                      >
                                        Take IP packets from WireGuard and
                                        reconstruct TCP streams
                                      </li>
                                      <li
                                        class="whitespace-normal break-words"
                                        index="2"
                                      >
                                        Present this as a normal socket
                                        interface to your application
                                      </li>
                                    </ol>
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="4"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>The Solution</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                gVisor's TCP/IP stack acts as this missing
                                piece:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    It accepts regular TCP connection requests
                                    from your application
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Handles all TCP protocol details
                                    (handshakes, windowing, retransmission)
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Packages everything into IP packets for
                                    WireGuard
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    Reconstructs TCP streams from incoming IP
                                    packets
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="4"
                                  >
                                    Presents everything as normal networking
                                    interfaces to your Go code
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              Without a user-mode TCP/IP stack, you'd have raw
                              IP packets but no way to turn them into the TCP
                              connections that applications like SSH expect. The
                              TCP/IP stack provides the necessary protocol
                              handling that the kernel usually provides.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            ohh, so what is the input and output of wireguard is
                            it ip packets? what exactly wireguard does?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me break down WireGuard's operation:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              WireGuard's Essentials:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Input/Output</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Input: IP packets (IPv4 or IPv6)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Output: Encrypted UDP datagrams
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Core Function</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                WireGuard is essentially an encrypted tunnel for
                                IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                It takes IP packets, encrypts them, and sends
                                them as UDP datagrams to the peer
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                On the receiving side, it decrypts UDP datagrams
                                back into the original IP packets
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              Here's the flow:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_30_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Application] 
</span></span><span>      IP Packets
</span><span>[WireGuard]
</span><span>      Encrypts &amp; Encapsulates
</span><span>[UDP Datagram]
</span><span>      Sent over internet
</span><span>[WireGuard Peer]
</span><span>      Decrypts &amp; Decapsulates         class="whitespace-normal break-words"
                                index="2"
                              >
                                WireGuard then takes these IP packets and
                                tunnels them
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                On the other end, WireGuard outputs IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="4"
                              >
                                These IP packets need to be reconstructed into
                                TCP streams (again, gVisor's job)
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              WireGuard itself doesn't care about TCP or
                              application protocols - it just sees IP packets
                              that it needs to securely tunnel to the other
                              side. All the TCP handling needs to happen before
                              and after WireGuard processes the packets.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <ol
                            class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                          >
                            <li class="whitespace-normal break-words">
                              <strong>Core Function</strong>:
                            </li>
                            <li class="whitespace-normal break-words">
                              WireGuard is essentially an encrypted tunnel for
                              IP packets
                            </li>
                            <li class="whitespace-normal break-words">
                              It takes IP packets, encrypts them, and sends them
                              as UDP datagrams to the peer
                            </li>
                            <li class="whitespace-normal break-words">
                              On the receiving side, it decrypts UDP datagrams
                              back into the original IP packets About this part,
                              what about when packets come back to client is the
                              same thing both ways?
                            </li>
                          </ol>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Yes, it's symmetrical! Let me break down the
                              bidirectional flow:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_29_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>Client Side                                      Server Side
</span></span><span>-----------                                      -----------
</span><span>
</span><span>[Your App]  TCP Stream                                            [Server App]
</span><span>                                                                        
</span><span>[TCP/IP Stack]  IP Packets                                    [TCP/IP Stack]
</span><span>                                                                        
</span><span>[WireGuard]  Encrypted UDP  Internet  Encrypted UDP  [WireGuard]</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              Both directions work the same way:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Client to Server</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Client app generates TCP traffic
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                TCP/IP stack converts to IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                WireGuard encrypts packets into UDP datagrams
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Server WireGuard decrypts UDP back to IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="4"
                              >
                                Server TCP/IP stack reconstructs TCP stream
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="5"
                              >
                                Server app receives data
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Server to Client</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Server app generates TCP traffic
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Server TCP/IP stack converts to IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Server WireGuard encrypts packets into UDP
                                datagrams
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Client WireGuard decrypts UDP back to IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="4"
                              >
                                Client TCP/IP stack reconstructs TCP stream
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="5"
                              >
                                Client app receives data
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              The beauty of WireGuard is that it's stateless and
                              treats both directions identically - it just
                              encrypts outgoing IP packets into UDP datagrams
                              and decrypts incoming UDP datagrams back into IP
                              packets, regardless of which side initiated the
                              communication.
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              In the Fly.io case with user-mode WireGuard, both
                              sides need the gVisor TCP/IP stack to handle the
                              TCP protocol because WireGuard itself only deals
                              with the IP packets, not TCP streams.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            my app -&gt; tcp server -&gt; usermode gvisor TCP/IP
                            stack (coonvert to packets) -&gt; usermode wireguard
                            -&gt; encrypt udp -&gt; Internet
                          </p>
                          <p class="whitespace-pre-wrap break-words">
                            is this correct?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Almost! Let me correct and detail the flow:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_28_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[My App (e.g., SSH client)] 
</span></span><span>        
</span><span>        TCP connection request
</span><span>       
</span><span>[User-mode gVisor TCP/IP Stack]
</span><span>        
</span><span>        IP Packets
</span><span>       
</span><span>[User-mode WireGuard]
</span><span>       
</span><span>        Encrypted UDP Datagrams
</span><span>       
</span><span>[Internet]</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              A few key points:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Your app (like SSH client) just tries to make a
                                normal TCP connection
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                gVisor's TCP/IP stack intercepts this connection
                                request and handles all TCP protocol details
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                The TCP/IP stack creates IP packets from the TCP
                                stream
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                WireGuard takes these IP packets, encrypts them,
                                and sends them as UDP
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              The important thing is that there's no separate
                              TCP server in between - gVisor's TCP/IP stack
                              directly handles the TCP connection from your
                              application. It effectively replaces what your
                              operating system's TCP/IP stack would normally do,
                              but does it all in user space.
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              Is there anything specific about this flow you'd
                              like me to explain further?
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            so why we need gvisor what does just wiregurad-go
                            does?
                          </p>
                          <p class="whitespace-pre-wrap break-words">
                            In the blog it says : """ But if you squint at
                            WireGuard and tilt your head the right way, you can
                            see thats not technically true. You need operating
                            system privileges to configure a new network
                            interface. But you dont need any privileges to send
                            packets to
                            <code
                              class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                              >51820/udp</code
                            >. You can run the whole WireGuard protocol as an
                            unprivileged userland process  thats how
                            wireguard-go works. That gets you as far as
                            handshaking WireGuard. But youre still not talking
                            over a WireGuard network, because you cant just
                            send random strings to the other end of a WireGuard
                            connection; your peer expects TCP/IP packets. The
                            native socket interface on your machine wont help
                            you establish a TCP connection over a random
                            connected UDP socket. """
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me break this down:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>wireguard-go</strong> can:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Run the WireGuard protocol (encryption,
                                handshaking) in userspace
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Send and receive encrypted UDP datagrams without
                                root privileges
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                That's basically it!
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong
                                  >The Problem wireguard-go can't solve
                                  alone</strong
                                >:
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_27_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your App] wants to make TCP connection
</span></span><span>       
</span><span>[wireguard-go] can only send/receive UDP
</span><span>       
</span><span>But can't handle: "How do we turn TCP connections into IP packets?"</span></code></div></div></div></pre>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="3"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Why gVisor is needed</strong>:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Your app wants to make a normal TCP connection
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                The operating system's TCP/IP stack can't help
                                because it can't send its packets through
                                wireguard-go
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                gVisor provides a complete TCP/IP stack that
                                can:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Accept TCP connections from your app
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Handle all TCP protocol stuff (handshakes,
                                    retransmission, etc.)
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Create IP packets that wireguard-go can then
                                    encrypt and send
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              Without gVisor, wireguard-go could establish the
                              encrypted tunnel, but there would be no way to:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Take a TCP connection from your application
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Turn it into IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Get those packets into wireguard-go
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Reconstruct TCP streams from received packets
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              gVisor fills this gap by providing all the TCP/IP
                              handling that normally happens in the kernel, but
                              in userspace where it can work with wireguard-go.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            so if I was only using UDA, only wiregurad-go would
                            be enough?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Yes, exactly! If you were only dealing with UDP
                              traffic, wireguard-go alone would be sufficient
                              because:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                wireguard-go can already:
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Send UDP datagrams without root privileges
                                (using normal UDP sockets)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Handle the WireGuard protocol (encryption,
                                handshaking)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Encapsulate and decapsulate packets within UDP
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              Example UDP-only scenario:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_26_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your UDP App]  UDP datagrams   [wireguard-go]  encrypted UDP  Internet</span></span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              The reason gVisor isn't needed here is that:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                UDP is connectionless and stateless
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                There's no need for connection handling,
                                sequencing, or retransmission
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                You can directly send UDP datagrams through
                                wireguard-go
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              The complexity with TCP (why gVisor is needed)
                              comes from:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Connection establishment (3-way handshake)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Maintaining connection state
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Ordering packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Handling retransmission
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="4"
                              >
                                Flow control
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="5"
                              >
                                And other TCP protocol requirements
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              So yes, for a simple UDP-based application,
                              wireguard-go alone would be sufficient for
                              creating a secure tunnel without requiring root
                              privileges or kernel modifications.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            That gets you as far as handshaking WireGuard. But
                            youre still not talking over a WireGuard network,
                            because you cant just send random strings to the
                            other end of a WireGuard connection; your peer
                            expects TCP/IP packets. The native socket interface
                            on your machine wont help you establish a TCP
                            connection over a random connected UDP socket.
                          </p>
                          <p class="whitespace-pre-wrap break-words">
                            can you explain this in detail line by line
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let's break this down line by line:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >That gets you as far as handshaking
                                  WireGuard.</code
                                >
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                wireguard-go can establish the encrypted
                                connection (handshake) with the peer
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                This means both sides agree on encryption keys
                                and are ready to communicate
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >But you're still not talking over a WireGuard
                                  network, because you can't just send random
                                  strings to the other end of a WireGuard
                                  connection;</code
                                >
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Even though the connection is established, you
                                can't just send any data
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                WireGuard expects specifically formatted packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                "random strings" here means raw application data
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="3"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >your peer expects TCP/IP packets.</code
                                >
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                WireGuard is designed to tunnel IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                The peer on the other end expects to receive
                                properly formatted IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                These IP packets might contain TCP segments, UDP
                                datagrams, or other IP-based protocols
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                But the key is they must be valid IP packets
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="4"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >The native socket interface on your machine
                                  won't help you establish a TCP connection over
                                  a random connected UDP socket.</code
                                >
                              </li>
                            </ol>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Your operating system's socket API can create
                                TCP or UDP connections
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                But it can't:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Create a TCP connection that runs over your
                                    custom UDP tunnel (WireGuard)
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Convert TCP streams into IP packets that can
                                    be sent through WireGuard
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Handle TCP protocol requirements
                                    (handshakes, sequencing, etc.) over this
                                    custom tunnel
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              This is why gVisor is needed - it provides the
                              missing piece that can:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Accept normal TCP connections from applications
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Handle all TCP protocol requirements
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Create proper IP packets that WireGuard expects
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Do all this in userspace without kernel
                                privileges
                              </li>
                            </ol>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            The peer on the other end - what is peer in this
                            context
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              In the WireGuard context, a "peer" refers to the
                              other endpoint of the WireGuard connection. Let me
                              explain with Fly.io's specific case:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_25_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Computer]                              [Fly.io Server]
</span></span><span>(WireGuard Client) &lt;--------------------&gt; (WireGuard Server)
</span><span>     ^                                           ^
</span><span>     |                                           |
</span><span>    Peer 1                                     Peer 2</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              Each side is a "peer" to the other because
                              WireGuard uses a peer-to-peer model where:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Both sides run the WireGuard protocol
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Both sides can send and receive encrypted
                                traffic
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Both sides expect to receive properly formatted
                                IP packets from each other
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              In the Fly.io article's context:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                One peer is your local machine running
                                wireguard-go in userspace
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                The other peer is the Fly.io server running
                                WireGuard (likely in kernel space)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                When they say "your peer expects TCP/IP
                                packets", they mean the Fly.io server's
                                WireGuard endpoint expects to receive properly
                                formatted IP packets through the encrypted
                                tunnel
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              This is different from a traditional client-server
                              model because in WireGuard:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                There's no inherent hierarchy
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Both sides are equal participants in the
                                protocol
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Both sides must handle the same packet format
                                requirements
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Either side can initiate communication
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            When they say "your peer expects TCP/IP packets",
                            they mean the Fly.io server's WireGuard endpoint
                            expects to receive properly formatted IP packets
                            through the encrypted tunnel
                          </p>
                          <p class="whitespace-pre-wrap break-words">
                            but you said before that wireguard expect UDP
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Ah, let me clarify this important distinction:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>WireGuard Transport</strong> (How
                                WireGuard talks over the Internet):
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_24_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[WireGuard]  Encrypted UDP Datagrams  Internet  [WireGuard Peer]</span></span></code></div></div></div></pre>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Yes, WireGuard uses UDP for its transport
                                between peers
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                UDP port 51820 is typically used
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                This is how the encrypted tunnel itself operates
                              </li>
                            </ul>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>WireGuard Payload</strong> (What goes
                                inside the tunnel):
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_23_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Data]  IP Packets  [WireGuard Encrypted Tunnel]  IP Packets  [Peer]</span></span></code></div></div></div></pre>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Inside the UDP-based encrypted tunnel, WireGuard
                                expects IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                These IP packets can contain TCP, UDP, or any
                                other IP-based protocol
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              So when they say "your peer expects TCP/IP
                              packets", they mean:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                The actual data you send through the WireGuard
                                tunnel must be formatted as IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                These IP packets are then encrypted and sent
                                over UDP between the peers
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                When the peer decrypts the UDP datagram, it
                                expects to find valid IP packets inside
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              This is why we need gVisor:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                To create proper IP packets from TCP connections
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                These IP packets then get encrypted by WireGuard
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                WireGuard sends them as UDP datagrams
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                The peer receives UDP, decrypts it, and expects
                                to find valid IP packets
                              </li>
                            </ol>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            So when they say "your peer expects TCP/IP packets",
                            they mean: * The actual data you send through the
                            WireGuard tunnel must be formatted as IP packets *
                            These IP packets are then encrypted and sent over
                            UDP between the peers * When the peer decrypts the
                            UDP datagram, it expects to find valid IP packets
                            inside still not clear where TCP is coming here
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Ah, let me clarify where TCP comes into play:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              When they say "TCP/IP packets", they're actually
                              talking about IP packets that may contain TCP
                              segments inside them. Let me break down the
                              layers:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Application Layer</strong>:
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_22_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your SSH Client] wants to make a TCP connection</span></span></code></div></div></div></pre>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="2"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Transport Layer (TCP)</strong>:
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_21_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>TCP segments (containing your SSH data)</span></span></code></div></div></div></pre>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="3"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Network Layer (IP)</strong>:
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_20_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>IP packets (containing TCP segments)</span></span></code></div></div></div></pre>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              start="4"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>WireGuard Tunnel</strong>:
                              </li>
                            </ol>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_19_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>Encrypted UDP datagrams (containing IP packets)</span></span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              So more precisely:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Your peer doesn't specifically expect TCP
                                packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                It expects IP packets (which might contain TCP
                                segments inside them)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                The "TCP/IP" phrase in the article is somewhat
                                imprecise
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                What they really mean is "IP packets that may
                                contain TCP segments"
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              That's why when the article says "your peer
                              expects TCP/IP packets", it would be more accurate
                              to say:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                "Your peer expects IP packets"
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                These IP packets might contain TCP segments, UDP
                                datagrams, or other protocols
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                The TCP part is just one possible payload of the
                                IP packets
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              Does this help clarify where TCP fits in the
                              picture?
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            can you explain this At first glance, not having
                            WireGuard installed seems like a dealbreaker. The
                            way WireGuard works is, you get a new network
                            interface on your machine, either a kernel-mode
                            WireGuard interface (on Linux) or a tunnel device
                            with a userland WireGuard service attached
                            (everywhere else). Without that network interface,
                            you cant talk over WireGuard.
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me break down how WireGuard normally works
                              versus what they're doing:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Normal WireGuard Setup</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_18_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Apps]  [Network Interface (wg0)]  [WireGuard]  Internet
</span></span><span>                      ^
</span><span>                      |
</span><span>     Requires root privileges to create</span></code></div></div></div></pre>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Traditional Installation:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Creates a virtual network interface (usually
                                    named wg0)
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    On Linux: runs in kernel mode
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    On other OS: creates a tunnel device +
                                    userland service
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    Requires root/admin privileges to create
                                    these interfaces
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Why Interface is Needed Normally:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Apps send traffic to this interface
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Operating system routes packets through this
                                    interface
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    WireGuard processes these packets
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    Traditional networking tools can use this
                                    interface
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Their Innovation</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_17_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Apps]  [gVisor TCP/IP Stack]  [wireguard-go]  Internet
</span></span><span>                    (userspace)         (userspace)</span></code></div></div></div></pre>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                No Network Interface Needed:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Instead of creating a system network
                                    interface
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    They use wireguard-go to handle WireGuard
                                    protocol
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Just sends UDP packets (no special
                                    privileges needed)
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    gVisor handles all the networking stack in
                                    userspace
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Key Advantage:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    No root privileges required
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    No system modifications
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Works entirely in userspace
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    More portable and easier to distribute
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              This is why they say "at first glance" - while
                              traditionally WireGuard needs a network interface,
                              they found a way to implement the functionality
                              without one.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            but they are saying "a tunnel device with a userland
                            WireGuard service attached (everywhere else).
                            Without that network interface, you cant talk over
                            WireGuard." can you explain this.
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me explain the traditional userland WireGuard
                              setup (like on macOS or Windows) versus what they
                              did:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Traditional Userland WireGuard</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_16_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Apps]  [Tunnel Device (tun0/wg0)]  [Userland WireGuard Service]  Internet
</span></span><span>                      ^                            ^
</span><span>                      |                            |
</span><span>             Requires admin rights          Runs in userspace
</span><span>              to create device</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              The key components:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Tunnel Device (tun0/wg0)</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    A virtual network interface
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Created at system level
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Requires admin privileges to create
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    Apps can send traffic to it like any network
                                    interface
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                <strong>Userland WireGuard Service</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Runs in userspace
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Attaches to the tunnel device
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Processes packets from the tunnel device
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="3"
                                  >
                                    Handles WireGuard protocol
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              When they say "Without that network interface, you
                              can't talk over WireGuard" - they mean in the
                              traditional setup, you need this tunnel device
                              because:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                It provides the interface for applications to
                                send traffic
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                It's how the operating system knows to route
                                traffic to WireGuard
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                It connects your system's networking stack to
                                the WireGuard service
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Their Innovation</strong> (Fly.io's
                              approach):
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_15_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Your Apps]  [gVisor TCP/IP Stack]  [wireguard-go]  Internet
</span></span><span>                (no tunnel device)     (just UDP socket)</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              They eliminated the need for the tunnel device by:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Using gVisor to handle all networking in
                                userspace
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Having applications talk directly to gVisor
                                instead of a system network interface
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Using regular UDP sockets which don't require
                                special privileges
                              </li>
                            </ol>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            is "Userland WireGuard Service" same as
                            "wireguard-go"?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Yes!
                              <code
                                class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                >wireguard-go</code
                              >
                              is basically the userland implementation of
                              WireGuard.
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              So in the traditional setup on non-Linux systems
                              (like macOS):
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_14_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [Tunnel Device]  [wireguard-go]  Internet
</span></span><span>          (needs admin)     (userland)</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              What Fly.io did:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_13_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [gVisor TCP/IP]  [wireguard-go]  Internet
</span></span><span>         (userland)         (userland)</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              The key difference is:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Traditional:
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >wireguard-go</code
                                >
                                needs a tunnel device to work with the system's
                                networking
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Fly.io's approach: They're using the same
                                <code
                                  class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                  >wireguard-go</code
                                >, but instead of a tunnel device, they're using
                                gVisor to handle all the networking stack
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              So
                              <code
                                class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                >wireguard-go</code
                              >
                              is doing the same thing in both cases
                              (implementing the WireGuard protocol in
                              userspace), but what's different is how traffic
                              gets to and from
                              <code
                                class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                >wireguard-go</code
                              >:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Traditional: through a system tunnel device
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Fly.io: through gVisor's userspace networking
                                stack
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              That's why they cleverly note that while you need
                              admin rights to create the tunnel device, you
                              don't actually need them to run the WireGuard
                              protocol itself (via
                              <code
                                class="bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.3rem] px-1 py-px text-[0.9rem]"
                                >wireguard-go</code
                              >).
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            what is a tunnel device (tun0) exactly? and does it
                            output UDP?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me explain what a TUN device is:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>TUN Device (tun0)</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_12_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Applications]  IP Packets  [TUN Device]  Raw IP Packets  [Program reading from TUN]</span></span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              A TUN device is a virtual network interface that:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Operates at Layer 3 (Network Layer)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Deals with IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Acts like a pipe:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    One end appears as a regular network
                                    interface to applications
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Other end gives raw IP packets to the
                                    program that opened the device
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              It does NOT output UDP - it outputs raw IP
                              packets.
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              So in traditional WireGuard setup:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_11_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  IP Packets  [TUN Device]  IP Packets  [wireguard-go]  Encrypted UDP  Internet</span></span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              wireguard-go:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Reads raw IP packets from the TUN device
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Encrypts these IP packets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Encapsulates them in UDP datagrams
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Sends them over the internet
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              The TUN device is just the bridge between:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Your system's normal networking stack (which
                                apps use)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                The program that wants to handle raw IP packets
                                (wireguard-go in this case)
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              That's why Fly.io needed gVisor - without a TUN
                              device, they needed something else to create the
                              IP packets that wireguard-go expects.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            something wrong here [Apps]  IP Packets app does
                            not send IP packets directly?
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Ah yes, you're absolutely right! Let me correct
                              this:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              Regular Apps typically operate at the Transport
                              Layer (L4) using TCP/UDP sockets. Here's the
                              correct flow:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Traditional WireGuard Setup</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_10_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  TCP/UDP Connections  [OS TCP/IP Stack]  IP Packets  [TUN Device]  IP Packets  [wireguard-go]  Encrypted UDP  Internet
</span></span><span>              (L4)                   (L3/L4)          (L3)</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>What Apps Actually Do</strong>:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Create TCP connections (like HTTP/SSH) or UDP
                                sockets
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                The Operating System's TCP/IP stack:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Handles TCP protocol if needed
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Creates IP packets
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Routes them appropriately
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              This is exactly why gVisor is needed in their
                              userspace solution:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_9_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  TCP Connections  [gVisor TCP/IP Stack]  IP Packets  [wireguard-go]  Encrypted UDP  Internet
</span></span><span>          (L4)                  (L3/L4)              (L3)</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              gVisor replaces the OS TCP/IP stack's role of
                              converting high-level TCP connections into the IP
                              packets that wireguard-go expects.
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              Thank you for catching this! It's an important
                              distinction in understanding the networking layers
                              involved.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            At first glance, not having WireGuard installed
                            seems like a dealbreaker. The way WireGuard works
                            is, you get a new network interface on your machine,
                            either a kernel-mode WireGuard interface (on Linux)
                            or a tunnel device with a userland WireGuard service
                            attached (everywhere else). Without that network
                            interface, you cant talk over WireGuard.
                          </p>
                          <p class="whitespace-pre-wrap break-words">
                            what is differnce between " network interface" and
                            "tunnel device "
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              In the context of WireGuard, let me clarify the
                              terms:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Linux (kernel-mode) implementation</strong
                              >:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_8_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [wg0 Network Interface]  [Kernel WireGuard Module]  Internet
</span></span><span>           (Network Interface)        (Built into kernel)</span></code></div></div></div></pre>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                WireGuard runs directly in the kernel
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Creates a regular network interface (wg0)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Everything is handled at kernel level
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Other OS (userland) implementation</strong
                              >:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_7_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [tun0 Tunnel Device]  [wireguard-go]  Internet
</span></span><span>         (Virtual Interface)     (Userspace service)</span></code></div></div></div></pre>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Uses a TUN device (special type of virtual
                                network interface)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                wireguard-go runs in userspace and attaches to
                                this TUN device
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              The distinction:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                A "network interface" is a general term for any
                                interface that can handle network traffic
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                A "tunnel device" (TUN device) is a specific
                                type of virtual network interface that:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    Is designed for tunneling
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    Provides raw packet access to userspace
                                    programs
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="2"
                                  >
                                    Is commonly used for VPNs and similar tools
                                  </li>
                                </ul>
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              So in the article, they're using these terms to
                              distinguish between:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Linux's native kernel implementation (regular
                                network interface)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Other OS's userspace implementation (tunnel
                                device + userspace service)
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              But functionally to applications, both appear as
                              network interfaces they can send traffic to.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            I am not sure what is the diffreence betweeen "wg0
                            network interface" and "tun0 tunnel Device" both
                            need sudo access
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              You're right - both require sudo/admin access to
                              create. Let me clarify what's actually different:
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Linux (wg0)</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_6_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [wg0 interface]  [WireGuard kernel module]  Internet
</span></span><span>                               
</span><span>           |                    |
</span><span>    needs sudo            runs in kernel</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>Other OS (tun0)</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_5_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [tun0 interface]  [wireguard-go]  Internet
</span></span><span>                               
</span><span>           |                    |
</span><span>    needs sudo            runs in userspace</span></code></div></div></div></pre>
                            <p class="whitespace-pre-wrap break-words">
                              The main differences:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Implementation Location</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    wg0: WireGuard protocol is implemented in
                                    kernel
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    tun0: WireGuard protocol (wireguard-go) runs
                                    in userspace
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                <strong>Interface Type</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    wg0: A specialized network interface
                                    specifically for WireGuard
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    tun0: A generic tunnel interface that
                                    wireguard-go attaches to
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              But you're absolutely right - from a permissions
                              perspective, there's no real difference:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Both require sudo/admin rights to create
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Both appear as network interfaces to
                                applications
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Both need system-level privileges to set up
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              This is exactly why Fly.io wanted to avoid both
                              approaches and run everything in userspace without
                              any special interfaces.
                            </p>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div class="mb-1 mt-1">
                    <div
                      class="group relative inline-flex gap-2 bg-gradient-to-b from-bg-300 from-50% to-bg-400 rounded-xl ml-px pl-2.5 py-2.5 break-words text-text-200 transition-all max-w-[75ch] flex-col shadow-[0_2px_16px_rgba(0,0,0,0.025)] pr-6"
                    >
                      <div class="flex flex-row gap-2">
                        <div class="shrink-0">
                          <div
                            class="flex shrink-0 items-center justify-center rounded-full font-bold h-7 w-7 text-[12px] bg-text-200 text-bg-100"
                          >
                            K
                          </div>
                        </div>
                        <div
                          data-testid="user-message"
                          class="font-user-message grid grid-cols-1 gap-2 py-0.5 text-[0.9375rem] leading-6"
                        >
                          <p class="whitespace-pre-wrap break-words">
                            can you go techinacally what is the difference
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-test-render-count="1">
                  <div style="height: auto">
                    <div
                      data-is-streaming="false"
                      class="group relative pt-3.5 pb-[1.125rem] px-4 relative rounded-2xl -tracking-[0.015em] bg-[linear-gradient(to_bottom,_hsla(var(--bg-000)/0.75)_0%,_hsla(var(--bg-000)_/_0)_90%)] before:absolute before:inset-0 before:bg-[radial-gradient(ellipse_at_left_top,_hsla(var(--bg-000)/0.5)_0%,_hsla(var(--bg-000)/0.3)_60%)] before:rounded-2xl before:border-[0.5px] before:border-[hsla(var(--border-100)/0.15)] before:shadow-[0_4px_24px_rgba(0,0,0,0.015)] before:[transition:opacity_150ms_ease-out,_transform_250ms_cubic-bezier(0.695,0.555,0.655,1.650)] before:z-0 before:data-[is-streaming=&quot;true&quot;]:opacity-0 before:data-[is-streaming=&quot;true&quot;]:scale-[0.995] before:data-[is-streaming=&quot;false&quot;]:pointer-events-none"
                    >
                      <div
                        class="font-claude-message pr-4 md:pr-9 relative leading-[1.65rem] [&amp;_pre>div]:bg-bg-300 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_pre]:-mr-4 md:[&amp;_pre]:-mr-9"
                      >
                        <div>
                          <div
                            class="grid-cols-1 grid gap-2.5 [&amp;_>_*]:min-w-0"
                          >
                            <p class="whitespace-pre-wrap break-words">
                              Let me go technically into the difference between
                              WireGuard's kernel interface (wg0) and a TUN
                              interface (tun0):
                            </p>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>WireGuard Kernel Interface (wg0)</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_4_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [TCP/UDP]  [Kernel TCP/IP]  [wg0 interface]  [WireGuard kernel module]
</span></span><span>                                                                    
</span><span>                                    Network Device Driver    Implements entire WireGuard
</span><span>                                                           protocol in kernel space</span></code></div></div></div></pre>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Implemented as a kernel module
                                (drivers/net/wireguard/)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                Registers as a native network device driver
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Handles encryption, decryption, and protocol in
                                kernel space
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Optimized for kernel-level operation
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="4"
                              >
                                Implements WireGuard-specific handshaking and
                                encryption
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              <strong>TUN Device (tun0)</strong>:
                            </p>
                            <pre><div class="relative flex flex-col rounded-lg"><div class="text-text-300 absolute pl-3 pt-2.5 text-xs"></div><div class="pointer-events-none sticky my-0.5 ml-0.5 flex items-center justify-end px-1.5 py-1 mix-blend-luminosity top-0" id="__FPSC_ID_3_1736707106048" style=""><div class="from-bg-300/90 to-bg-300/70 pointer-events-auto rounded-md bg-gradient-to-b p-0.5 backdrop-blur-md"><button class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200 opacity-60 hover:opacity-100"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 256 256" class="text-text-500 mr-px -translate-y-[0.5px]"><path d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"></path></svg><span class="text-text-200 pr-0.5">Copy</span></button></div></div><div><div class="code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed" style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none; padding: 1em; margin: 0.5em 0px; overflow: auto; border-radius: 0.3em;"><code style="background: rgb(40, 44, 52); color: rgb(171, 178, 191); text-shadow: rgba(0, 0, 0, 0.3) 0px 1px; font-family: &quot;Fira Code&quot;, &quot;Fira Mono&quot;, Menlo, Consolas, &quot;DejaVu Sans Mono&quot;, monospace; direction: ltr; text-align: left; white-space: pre; word-spacing: normal; word-break: normal; line-height: 1.5; tab-size: 2; hyphens: none;"><span><span>[Apps]  [TCP/UDP]  [Kernel TCP/IP]  [tun0 device]  [Userspace program (wireguard-go)]
</span></span><span>                                                                    
</span><span>                                    Character Device       Reads/writes raw IP packets
</span><span>                                    (/dev/net/tun)        through file descriptor</span></code></div></div></div></pre>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                Implemented as a character device (/dev/net/tun)
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                A kernel facility that provides packet
                                forwarding between kernel and userspace
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                Just moves packets between kernel and userspace
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                Generic - can be used by any tunneling program
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="4"
                              >
                                No protocol implementation - just a packet
                                transport mechanism
                              </li>
                            </ul>
                            <p class="whitespace-pre-wrap break-words">
                              Key Technical Differences:
                            </p>
                            <ol
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                <strong>Device Type</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    wg0: Network device driver
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    tun0: Character device
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                <strong>Implementation</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    wg0: Protocol implemented in kernel
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    tun0: Just a packet transport device,
                                    protocol implemented elsewhere
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="2"
                              >
                                <strong>Interface with Userspace</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    wg0: Configured through netlink
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    tun0: Accessed through file operations
                                    (read/write)
                                  </li>
                                </ul>
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="3"
                              >
                                <strong>Performance</strong>:
                                <ul
                                  class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                                  depth="1"
                                >
                                  <li
                                    class="whitespace-normal break-words"
                                    index="0"
                                  >
                                    wg0: Better performance (everything in
                                    kernel)
                                  </li>
                                  <li
                                    class="whitespace-normal break-words"
                                    index="1"
                                  >
                                    tun0: More overhead (context switches
                                    between kernel/userspace)
                                  </li>
                                </ul>
                              </li>
                            </ol>
                            <p class="whitespace-pre-wrap break-words">
                              Both need root access because:
                            </p>
                            <ul
                              class="[&amp;:not(:last-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7"
                              depth="0"
                            >
                              <li
                                class="whitespace-normal break-words"
                                index="0"
                              >
                                wg0: Needs to install kernel module and create
                                network device
                              </li>
                              <li
                                class="whitespace-normal break-words"
                                index="1"
                              >
                                tun0: Needs access to /dev/net/tun and create
                                network device
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      <div
                        class="absolute -bottom-0 -right-1.5"
                        style="transform: none"
                      >
                        <div
                          class="border-0.5 border-border-300 flex items-center translate-y-1/2 rounded-lg shadow-sm transition scale-95 opacity-0 group-hover:scale-100 group-hover:opacity-100 bg-bg-000 p-1"
                        >
                          <div
                            class="text-text-400 flex items-stretch justify-between gap-0.5"
                          >
                            <div class="flex gap-0.5">
                              <button
                                class="flex flex-row items-center gap-1 rounded-md p-1 py-0.5 text-xs transition-opacity delay-100 hover:bg-bg-200"
                              >
                                <svg
                                  xmlns="http://www.w3.org/2000/svg"
                                  width="1em"
                                  height="1em"
                                  fill="currentColor"
                                  viewBox="0 0 256 256"
                                >
                                  <path
                                    d="M200,32H163.74a47.92,47.92,0,0,0-71.48,0H56A16,16,0,0,0,40,48V216a16,16,0,0,0,16,16H200a16,16,0,0,0,16-16V48A16,16,0,0,0,200,32Zm-72,0a32,32,0,0,1,32,32H96A32,32,0,0,1,128,32Zm72,184H56V48H82.75A47.93,47.93,0,0,0,80,64v8a8,8,0,0,0,8,8h80a8,8,0,0,0,8-8V64a47.93,47.93,0,0,0-2.75-16H200Z"
                                  ></path></svg
                                >&nbsp;Copy
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div
                class="sticky bottom-0 mx-auto flex w-full flex-col items-center justify-center gap-3 pb-4 pt-4"
                id="__FPSC_ID_2_1736707106048"
                style=""
              >
                <a
                  target="_self"
                  class="inline-flex items-center justify-center relative shrink-0 ring-offset-2 ring-offset-bg-300 ring-accent-main-100 focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none disabled:drop-shadow-none bg-accent-main-100 bg-gradient-to-r from-accent-main-100 via-accent-main-200/50 to-accent-main-200 bg-[length:200%_100%] hover:bg-right active:bg-accent-main-000 border-0.5 border-border-300 text-oncolor-100 font-medium font-styrene drop-shadow-sm transition-all shadow-[inset_0_0.5px_0px_rgba(255,255,0,0.15)] [text-shadow:_0_1px_2px_rgb(0_0_0_/_10%)] active:shadow-[inset_0_1px_6px_rgba(0,0,0,0.2)] hover:from-accent-main-200 hover:to-accent-main-200 h-9 px-4 py-2 rounded-lg min-w-[5rem] active:scale-[0.985] whitespace-nowrap"
                  href="/new"
                  >Start Your Own Conversation</a
                >
              </div>
            </div>
            <div style="width: 0px">
              <div class="transition-[width] lg:w-[28rem]"></div>
              <div
                class="fixed bottom-0 top-0 flex w-full flex-col transition-[width] z-[5] right-0 md:w-[27rem] pointer-events-none pt-16 md:pb-4 md:pr-1"
                style="margin-right: 15px"
              >
                <div
                  class="bg-bg-100 border-0.5 border-border-300 flex-1 overflow-hidden rounded-xl shadow-lg"
                  tabindex="0"
                  style="
                    opacity: 0;
                    transform: translateX(100%) scaleX(0.925) translateZ(0px);
                  "
                >
                  <div class="flex h-full flex-col" style="opacity: 0"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="intercom-lightweight-app">
      <style id="intercom-lightweight-app-style" type="text/css">
        @keyframes intercom-lightweight-app-launcher {
          from {
            opacity: 0;
            transform: scale(0.5);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }

        @keyframes intercom-lightweight-app-gradient {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        @keyframes intercom-lightweight-app-messenger {
          0% {
            opacity: 0;
            transform: scale(0);
          }
          40% {
            opacity: 1;
          }
          100% {
            transform: scale(1);
          }
        }

        .intercom-lightweight-app {
          position: fixed;
          z-index: 2147483001;
          width: 0;
          height: 0;
          font-family: intercom-font, "Helvetica Neue", "Apple Color Emoji",
            Helvetica, Arial, sans-serif;
        }

        .intercom-lightweight-app-gradient {
          position: fixed;
          z-index: 2147483002;
          width: 500px;
          height: 500px;
          bottom: 0;
          right: 0;
          pointer-events: none;
          background: radial-gradient(
            ellipse at bottom right,
            rgba(29, 39, 54, 0.16) 0%,
            rgba(29, 39, 54, 0) 72%
          );
          animation: intercom-lightweight-app-gradient 200ms ease-out;
        }

        .intercom-lightweight-app-launcher {
          position: fixed;
          z-index: 2147483003;
          padding: 0 !important;
          margin: 0 !important;
          border: none;
          bottom: 20px;
          right: 20px;
          max-width: 48px;
          width: 48px;
          max-height: 48px;
          height: 48px;
          border-radius: 50%;
          background: #0099cc;
          cursor: pointer;
          box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.06),
            0 2px 32px 0 rgba(0, 0, 0, 0.16);
          transition: transform 167ms cubic-bezier(0.33, 0, 0, 1);
          box-sizing: content-box;
        }

        .intercom-lightweight-app-launcher:hover {
          transition: transform 250ms cubic-bezier(0.33, 0, 0, 1);
          transform: scale(1.1);
        }

        .intercom-lightweight-app-launcher:active {
          transform: scale(0.85);
          transition: transform 134ms cubic-bezier(0.45, 0, 0.2, 1);
        }

        .intercom-lightweight-app-launcher:focus {
          outline: none;
        }

        .intercom-lightweight-app-launcher-icon {
          display: flex;
          align-items: center;
          justify-content: center;
          position: absolute;
          top: 0;
          left: 0;
          width: 48px;
          height: 48px;
          transition: transform 100ms linear, opacity 80ms linear;
        }

        .intercom-lightweight-app-launcher-icon-open {
          opacity: 1;
          transform: rotate(0deg) scale(1);
        }

        .intercom-lightweight-app-launcher-icon-open svg {
          width: 24px;
          height: 24px;
        }

        .intercom-lightweight-app-launcher-icon-open svg path {
          fill: rgb(255, 255, 255);
        }

        .intercom-lightweight-app-launcher-icon-self-serve {
          opacity: 1;
          transform: rotate(0deg) scale(1);
        }

        .intercom-lightweight-app-launcher-icon-self-serve svg {
          height: 44px;
        }

        .intercom-lightweight-app-launcher-icon-self-serve svg path {
          fill: rgb(255, 255, 255);
        }

        .intercom-lightweight-app-launcher-custom-icon-open {
          max-height: 24px;
          max-width: 24px;

          opacity: 1;
          transform: rotate(0deg) scale(1);
        }

        .intercom-lightweight-app-launcher-icon-minimize {
          opacity: 0;
          transform: rotate(-60deg) scale(0);
        }

        .intercom-lightweight-app-launcher-icon-minimize svg path {
          fill: rgb(255, 255, 255);
        }

        .intercom-lightweight-app-messenger {
          position: fixed;
          z-index: 2147483003;
          overflow: hidden;
          background-color: white;
          animation: intercom-lightweight-app-messenger 250ms
            cubic-bezier(0, 1, 1, 1);
          transform-origin: bottom right;

          width: 400px;
          height: calc(100% - 40px);
          max-height: 704px;
          min-height: 250px;
          right: 20px;
          bottom: 20px;
          box-shadow: 0 5px 40px rgba(0, 0, 0, 0.16);

          border-radius: 16px;
        }

        .intercom-lightweight-app-messenger-header {
          height: 64px;
          border-bottom: none;
          background: #191919;
        }

        .intercom-lightweight-app-messenger-footer {
          position: absolute;
          bottom: 0;
          width: 100%;
          height: 80px;
          background: #fff;
          font-size: 14px;
          line-height: 21px;
          border-top: 1px solid rgba(0, 0, 0, 0.05);
          box-shadow: 0px 0px 25px rgba(0, 0, 0, 0.05);
        }

        @media print {
          .intercom-lightweight-app {
            display: none;
          }
        }
      </style>
    </div>
  </body>
</html>
